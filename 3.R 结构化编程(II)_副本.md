## 矩阵与数据框的访问

* **基本语法:** matrix[row, col]
	* row: 行索引
	* col: 列索引
	* 分隔符 , 必须存在
* **数据框特殊访问方式**
	* 作为列表的访问
		* 单括号：返回数据框
		* 双括号：返回向量
		* 美元符号：返回向量
	* 作为矩阵的访问
		* df[1,] 
		* df[,1]
		* df[1, 2]

## 矩阵创建与操作函数

* #### **矩阵创建函数**
	* matrix() 函数
	* matrix(data, nrow, ncol, byrow = FALSE, dimnames = NULL)
	* 参数说明：
		* data: 元素值
		* nrow: 行数
		* ncol: 列数
		* byrow = FALSE: 按列填充（默认），TRUE按行填充
		* dimnames: 行名和列名
	* 示例：
```r
#按列填充
matrix(1:6, nrow = 2, ncol = 3)
#     [,1] [,2] [,3] 
# [1,] 1     3    5 
# [2,] 2     4    6

#按行填充 
matrix(1:6, nrow = 2, ncol = 3, byrow = TRUE) 
#    [,1] [,2] [,3] 
# [1,] 1    2    3 
# [2,] 4    5    6
```

* `rbind()` 函数（按行绑定）
	* **用法：** rbind(...)
	* **功能：** 将多个向量或矩阵按行合并
	* 示例：
```r
x <- c(1, 2, 3)
y <- c(4, 5, 6)
rbind(x, y)
#   [,1] [,2] [,3]
# x    1    2    3
# y    4    5    6
```

* `cbind()` 函数（按列绑定）
	* **用法：** rbind(...)
	* **功能：** 将多个向量或矩阵按行合并
	* 示例：
```r
x <- c(1, 2, 3)
y <- c(4, 5, 6)
cbind(x, y)
#      x y
# [1,] 1 4
# [2,] 2 5
# [3,] 3 6
```

* `diag()` 函数（对角矩阵）
	* 用法：diag(x, nrow, ncol)
	* 功能1: 创建对角矩阵
```r
# 从向量创建对角矩阵
diag(c(1, 2, 3))
#      [,1] [,2] [,3]
# [1,]    1    0    0
# [2,]    0    2    0
# [3,]    0    0    3
```
* 功能2: 创建单位矩阵
```r
# 3×3 单位矩阵
diag(1, 3)
#      [,1] [,2] [,3]
# [1,]    1    0    0
# [2,]    0    1    0
# [3,]    0    0    1
```
* 功能3: 提取对角线元素
```r
m <- matrix(1:9, nrow = 3)
diag(m)       # 返回 c(1, 5, 9)
```

* `expand.grid()` 函数（网格扩展）
	* 用法：expand.grid(...)
	* 功能：生成所有因子组合的数据框
	* 示例：
```r
expand.grid(x = 1:2, y = c("a", "b"))
#   x y
# 1 1 a
# 2 2 a
# 3 1 b
# 4 2 b
```

* #### **矩阵信息查询函数**
* 维度信息函数

| 函数       | 功能   | 说明               |
| -------- | ---- | ---------------- |
| dim()    | 获取维度 | 返回 n(nrow, ncol) |
| nrow()   | 行数   | 专门针对矩阵和数据框       |
| ncol()   | 列数   | 专门针对矩阵和数据框       |
| NROW()   | 行数   | 对向量返回长度，对矩阵返回行数  |
| NCOL()   | 列数   | 对向量返回1， 对矩阵返回列数  |
| length() | 长度   | 对矩阵返回元素总数（行×列）   |
* 名称信息函数

| 函数         | 功能   | 说明                            |
| ---------- | ---- | ----------------------------- |
| names()    | 元素名称 | 向量或列表的元素名                     |
| colnames() | 列名   | `dimnames(x)[[2]]` 的别名        |
| rownames() | 行名   | `dimnames(x)[[1]]` 的别名        |
| dimnames() | 维度名  | 返回 `list(rownames, colnames)` |

## which() 函数详解

* **基本用法**
	* which(x, arr.ind = FALSE, useNames = TRUE)
	* 功能：返回逻辑向量中 `TRUE` 的位置
	* **返回值**：位置的整数向量（基于 1 的索引）
* **一维使用示例**
	* 简单逻辑向量
```r
x <- c(10, 20, 30, 40)
which(x > 15)
# 返回 c(2, 3, 4)（对应值 20, 30, 40）
```
	* 表达式生成的逻辑向量
```r
x <- c(1, 2, 3, 4, 5)
which(x %% 2 == 0)      # 偶数的位置
# 返回 c(2, 4)

which(x > 2 & x < 5)    # 满足条件的位置
# 返回 c(3, 4)
```
* **矩阵使用**
```r
#默认行为：矩阵按向量处理
m <- matrix(1:6, nrow = 2)
#     [,1] [,2] [,3]
# [1,]   1    3    5
# [2,]   2    4    6

which(m > 3)
# 返回 c(5, 6)
# 因为矩阵被展平为向量 c(1,2,3,4,5,6)
# 大于 3 的是第 5、6 个位置（对应值 5、6）
```

```r
#使用 `arr.ind = TRUE`：返回二维索引
m <- matrix(1:6, nrow = 2)
which(m > 3, arr.ind = TRUE)
#      row col
# [1,]   1   3
# [2,]   2   3
# 表示 (1,3) 和 (2,3) 两个位置（对应值 5、6）
```


## 属性系统综合理解

* **属性的本质**
	* 定义: 属性（Attributes）是附加在对象上的**名称-值对**，提供额外的元数据
	* 关键事实:
		* **重要结论 1**：R 中大多数你看到的"特殊"类型都是**向量或列表 + 属性**
			* factor = integer vector + "levels" attribute + class "factor"
			* matrix = numeric vector + "dim" attribute
			* data.frame = named list + "row.names" attribute + class "data.frame"
		* **重要结论 2**：操作属性可以改变对象的类型
```r
x <- c(1, 2, 3, 4, 5, 6)          # 向量
dim(x) <- c(2, 3)                 # 添加 dim 属性
# 现在 x 是矩阵！
dim(x) <- NULL                    # 删除 dim 属性
# 现在 x 又是向量！			
```
* **常见属性及其效果**
	* 属性查看和修改
```r 
#查看
attributes(x)        # 列出所有属性
attr(x, "name")      # 查看特定属性

# 快捷方式
names(x)             # 等同于 attr(x, "names")
class(x)             # 等同于 attr(x, "class")
dim(x)               # 等同于 attr(x, "dim")
```

```r 
#修改
attr(x, "name") <- value          # 单个属性
attributes(x) <- list(...)        # 多个属性

# 快捷方式
names(x) <- c(...)
class(x) <- "newclass"
dim(x) <- c(nrow, ncol)
```

* **class 属性的特殊性**
	* **单元素 vs 多元素**：
```r
# 通常是单个类名
class(c(1, 2))       # "numeric"
class(matrix(1:4))   # "matrix"

# 但可以是多个（用于多重继承）
class(ordered(c(1,2,3)))  # c("ordered", "factor")
```