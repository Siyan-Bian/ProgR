## (a)
```r
ex01DataToLong <- function(data) {
  # your code
  assertDataTable(data)
  data[, .(school = school, subject = names(grades[[1]]), grade = grades[[1]]), by = student.id]
}
```


## (b)
```r
ex02DataStats <- function(data, group.by) {
  # your code
  assertDataTable(data)
  assertChoice(group.by, c("school", "subject", "both"))
  group.by <- c(if (group.by != "subject") "school", if (group.by != "school") "subject")
  ex01DataToLong(data)[, .(mean = mean(grade), sd = sd(grade)), by = group.by]
}
```


## (c)
```r
ex03DataCount <- function(data) {
  # your code
  assertDataTable(data)
  data <- ex01DataToLong(data)
  aggr <- data[, .(students = length(student.id)), by = c("school", "subject")]
  aggr <- aggr[CJ(school, subject, unique = TRUE), on = c("school", "subject")]
  aggr$students <- nafill(aggr$students, fill = 0)
  aggr
}
```


## (d)
```r
ex04DataWide <- function(data) {
  # your code
  assertDataTable(data)
  dcast(ex01DataToLong(data)[, subject := paste0("grade.", subject)],
    student.id + school ~ subject, value.var = "grade")[data$student.id, on = "student.id"]
}
```