## (a)
```r
ex01MonthlyUsers <- function(ledger, year) {
  # your code
  assertDataTable(ledger)
  assertInt(year, tol = 1e-100)
  ledger[, user := ifelse(src == "DEPOSIT", dst, src)]
  ret <- ledger[yr == year, .(users = length(unique(user))),
    keyby = .(month = mth)][J(1:12)]
  setnafill(ret, fill = 0, cols = "users")[]
}
```


## (b)
```r
ex02Transactions <- function(ledger, year, month) {
  # your code
  assertDataTable(ledger)
  assertInt(year)
  assertInt(month, lower = 1, upper = 12)
  begin <- as.Date(ISOdate(year, month, 1)) - 9
  end <- if (month == 12) {
    as.Date(ISOdate(year, month, 31))
  } else {
    as.Date(ISOdate(year, month + 1, 1)) - 1
  }
  dseq <- seq(begin, end, by = "day")
  template <- data.table(yr = year(dseq), mth = month(dseq), day = mday(dseq))
  res <- ledger[template, on = c("yr", "mth", "day")]
  res <- res[, .(transactions = sum(!is.na(amt))), by = c("yr", "mth", "day")]
  res[, transactions := frollmean(res$transactions, 10)]
  res[- (1:9)]
}
```