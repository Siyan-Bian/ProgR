## (a)模拟小鼠体重实验
##### 实验设置：
- 研究食物补充剂对小鼠生长的影响
- 对照组：大量小鼠，已知精确的平均体重
- 处理组：少量小鼠，喂食补充剂
- **限制条件**：体重测量只能精确到整数克（四舍五入）

##### 零假设（H₀）：
补充剂无效，处理组小鼠体重与对照组平均体重相同（但有正态分布的随机波动）

##### ✅ 解决方案
```r
ex01MouseWeightSim <- function(weight.avg, weight.stdev, treatment.size) {
  #参数验证
  assertNumber(weight.avg, lower = 0)  #平均体重必须 ≥ 0
  assertNumber(weight.stdev, lower = 0)  #标准差必须 ≥ 0
  assertCount(treatment.size, positive = TRUE)  #处理组大小必须是正整数
  
  #生成正态分布的随机体重
  weights.true <- rnorm(treatment.size,  #生成数量
						mean = weight.avg,  #均值
						sd = weight.stdev)  #标准差
  
  #四舍五入到整数（模拟测量误差）
  round(weights.true)
}
```


## (b)计算近似 P 值
##### 观察到的数据：
- 对照组平均体重：`control.weight.avg`（已知）
- 处理组体重：`treatment.weights`（观察值）
- 差异：`|mean(treatment.weights) - control.weight.avg|`

##### 问题：
如果零假设为真（补充剂无效），观察到这么大（或更大）差异的概率是多少？

##### ✅ 解决方案
```r
ex02MouseWeightPVal <- function(control.weight.avg, weight.stdev, 
                                treatment.weights, simulation.rounds) {
  #参数验证
  assertNumber(control.weight.avg, lower = 0)  #对照组平均体重：非负数
  assertNumber(weight.stdev, lower = 0)  #标准差：非负数
  assertIntegerish(treatment.weights, lower = 0, min.len = 1, 
                   any.missing = FALSE, tol = 0)
  assertCount(simulation.rounds, positive = TRUE, tol = 0)  #模拟轮数：正整数
  
  #计算观察到的差异
  weight.diff <- abs(mean(treatment.weights) - control.weight.avg)
  
  #模拟实验多次
  #simulations 是一个向量，包含每次模拟的差异
  simulations <- replicate(simulation.rounds, {
    #模拟一次实验（零假设为真）
    simulated.weights <- ex01MouseWeightSim(
      control.weight.avg,   #均值 = 对照组均值
      weight.stdev,  #标准差
      treatment.size = length(treatment.weights)  #样本量相同
    )
    
    #计算模拟实验的差异
    abs(mean(simulated.weights) - control.weight.avg)
  })
  
  #计算 P 值
  mean(simulations >= weight.diff)
}
```