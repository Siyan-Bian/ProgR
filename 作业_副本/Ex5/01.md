## 题目: R语言作业评分函数详细分析

##### 函数目标
编写一个函数 `ex01ProgrGrading`，用于对编程课程作业进行评分。
##### 输入参数
**1. problems（问题列表）**
- 类型：字符向量
- 格式：`"rfile.R:ex01FunctionName"`
- 示例：`"01_exercise_getting_started.R:ex01Multiply"`
- 说明：冒号前是"问题集"（problem set），冒号后是"问题"（problem）

**2. completion（完成情况）**
- 类型：数据框（data.frame）
- 包含两列：
    - `student`：学生姓名（字符型）
    - `solved`：该学生完成的问题（字符型）
- 说明：每行代表一个学生完成的一个问题
##### 评分规则
- 每个问题集（.R文件）完全完成后，得 **0.25分**
- 只有当学生完成了某个问题集中的**所有**问题，才能得该问题集的分数
- 部分完成不得分

```r
ex01ProgrGrading <- function(problems, completion) {
  # your code
  assertCharacter(problems, any.missing = FALSE)  #检查problems参数为字符向量
  assertDataFrame(completion, ncols = 2)  #检查completion参数为数据框，恰好有2列
  assertSubset(colnames(completion), c("student", "solved"))
  assertSubset(completion$solved, problems)

  #按冒号分割每个问题字符串
  problem.split <- strsplit(problems, ":")
  #提取问题集名称（冒号前的部分），problemsets是一个字符向量，包含所有问题集的名称
  problemsets <- vapply(problem.split, function(problem.parts) {
    assertCharacter(problem.parts, len = 2, min.chars = 1, any.missing = FALSE)
    problem.parts[[1]]  #返回第一个元素，即问题集名称（文件名）
  }, "")

  #处理空数据框的特殊情况
  if (!nrow(completion)) return(numeric(0))  #如果没有任何完成记录，返回空数值向量

  #计算每个学生的得分
  res <- tapply(completion$solved, completion$student, function(completed) {
    uncompleted <- setdiff(problems, completed)  #找出未完成的问题
    uncompleted.sets <- unique(sub(":.*", "", uncompleted)) #提取未完成问题所属问题集
    completed.sets <- setdiff(problemsets, uncompleted.sets)  #找出完全完成的问题集
    length(completed.sets) * .25  #计算得分
  })
  c(res)  #转换返回值格式，将tapply()返回的数组转换为普通的命名数值向量
}
```
* **assertSubset():** 检查第一个参数是否为第二个参数的子集
* **strsplit():** 字符串分割函数
	* 第一个参数: 要分割的字符向量
	* 第二个参数: 分隔符
	* 返回值: 一个列表
* **vapply(X, FUN, FUN.VALUE):** 
	* **X:** 要遍历的列表
	* **FUN:** 应用到每个元素的函数
	* **FUN.VALUE:** 返回值的类型模版（这里是""，表示返回字符串）
	* 与sapply()类似，但更安全，因为预先指定了返回值类型
* **assertCharacter(X, len, min.chars, any.missing = FALSE):**
	* **X:** 检查对象字符串向量
	* **len:** 字符串向量长度
	* **min.chars:** 每个元素最少的字符数（避免空字符串）
* **tapply(X, INDEX, FUN):** 对数据按分组应用函数
	* **X:** 要处理的数据
	* **INDEX:** 分组依据
	* **FUN:** 应用到每组的函数
	* **返回值:** 一个命名的数组，学生名为名称，得分为值
* **setdiff(A, B):** 集合差运算，返回在A中但不在B中的元素
	* **示例:**
```r
problems <- c("A:1", "A:2", "B:1")
completed <- c("A:1", "B:1")
uncompleted <- setdiff(problems, completed)
# 结果: "A:2"
```
* **sub(pattern, replacement, x):** 字符串替换
	* **pattern:** 正则表达式模式
		* **正则表达式 `:.*` 解析：**
			- `:`：匹配冒号字符
			- `.`：匹配任意字符
			- `*`：匹配0次或多次（贪婪匹配）
			- `:.*`：匹配从冒号开始到字符串结尾的所有内容
	* **replacement:** 替换成的内容
	* **x:** 要处理的字符向量
	* **sub(":.*", "", uncompleted) 的作用：**
		* 把 `"A:ex01Func"` 替换成 `"A"`
		- 把 `"B:ex02Func"` 替换成 `"B"`
		- 即：删除冒号及之后的所有内容
- **unique():** 去除重复值（因为同一个问题集可能有多个未完成的问题）