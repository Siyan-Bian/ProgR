* 实现一个名为`listHoursWorked`的函数，用于根据考勤日志计算每位员工的总工作时长。该日志包含每位员工的`clock-in`和`clock-out`事件，用于记录其工作时长。

* 该函数应返回包含每位员工总工时的表格。若某员工在特定日期存在缺失的
`clock-in`或`clock-out`事件，或同一天出现多个`clock-in`或`clock-out`事件，则应抛出包含字符串`“corrupted data”`的错误。

##### 输入
* `attendance.log`：包含以下列的 `data.table`：
	* `name`：`character` 列，表示员工姓名
	* `day`：`character` 列（格式 `YYYY-MM-DD`），表示日志条目日期
	* `hour`：整数型`numeric`列，取值范围`0`至`23`，表示事件发生时段
	* `event`：`character`列，取值为`“clock-in”`或`“clock-out”`，表示员工开始或结束工作班次
##### 输出
* 包含以下列的 `data.table`：
	* `name`：`character` 列，表示员工姓名
	* `hours.worked`：`numeric` 列，记录每位员工的总工作时长

```r
listHoursWorked <- function(attendance.log) {
  # your code
  # 参数检查
  checkmate::assert_data_table(attendance.log)
  
  # 统计 clock-in 和 clock-out 次数
  check <- attendance.log[, .(
    clock_in_count = sum(event == "clock-in"),
    clock_out_count = sum(event == "clock-out")
  ), by = .(name, day)]
  
  # 抛出错误 (每天必须恰好有1次clock-in和1次clock-out)
  if (any(check$clock_in_count != 1) || any(check_out_count != 1)) {
    stop("corrupted data")
  }
  
  # 计算每人每天的工时
  daily_hours <- attendance.log[, .(
    hours = hour[event == "clock-out"] - hour[event == "clock-in"]),
    by = .(name, day)]
  
  # 按人汇总工时
  result <- daily_hours[, .(hours.worked = sum(daily_hours)), by = name]
  
  result
}
```